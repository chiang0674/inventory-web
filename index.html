<!doctype html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>盤點系統</title>
  <link rel="manifest" href="manifest.webmanifest">
  <link rel="stylesheet" href="style.css">
  <meta name="theme-color" content="#111827" />
</head>
<body>

<header class="topbar">
  <div class="brand">
    盤點系統 <span id="appVersion" class="ver"></span>
  </div>
  <div class="actions">
    <button id="btnExport" class="btn secondary">匯出 CSV</button>
    <button id="btnClear" class="btn danger">清空</button>
  </div>
</header>

<main class="container">
  <section class="panel">
    <div class="row">
      <button id="btnStartScan" class="btn primary">開始掃描</button>
      <button id="btnStopScan" class="btn secondary" disabled>停止掃描</button>
    </div>

    <div class="hint">
      支援：EAN-13 / Code128（只掃框內；ROI 解碼放大 1.5 倍；掃到後輸入數量，確定後回到掃描）
    </div>

    <div class="scanner">
      <video id="video" playsinline muted></video>
      <div id="scanBox" class="scanBox" aria-hidden="true"></div>
      <div id="scanStatus" class="scanStatus">尚未開始掃描</div>
    </div>
  </section>

  <section class="panel" id="manualPanel">
    <div class="panelHeader">
      <div class="panelTitle">手動輸入（累加）</div>
      <div class="badge">保底</div>
    </div>

    <label class="field">
      <span>條碼</span>
      <input id="manualBarcode" autocomplete="off" placeholder="輸入條碼">
    </label>

    <div class="quickRow">
      <button id="btnAdd1" class="btn secondary">+1</button>
      <button id="btnAdd5" class="btn secondary">+5</button>
      <button id="btnAdd10" class="btn secondary">+10</button>
      <button id="btnAddCustom" class="btn primary">自訂</button>
    </div>
  </section>

  <section class="panel">
    <div class="panelHeader">
      <div class="panelTitle">盤點清單</div>
      <div id="count" class="badge">0</div>
    </div>
    <ul id="list" class="list"></ul>
  </section>
</main>

<dialog id="qtyDialog" class="dialog">
  <form method="dialog" class="dialogBody">
    <div class="dialogTitle">輸入盤點數量</div>
    <div id="dlgCode" class="dialogSub"></div>

    <div class="quickQtyRow">
      <button id="btnQ1" class="btn secondary" type="button">1</button>
      <button id="btnQ3" class="btn secondary" type="button">3</button>
      <button id="btnQ5" class="btn secondary" type="button">5</button>
      <button id="btnManualJump" class="btn secondary" type="button">手動輸入</button>
    </div>

    <label class="field">
      <span>數量（整數）</span>
      <input id="qtyInput" inputmode="numeric" pattern="[0-9]*" autocomplete="off" placeholder="例如 1">
    </label>

    <div class="dialogActions">
      <button id="dlgCancel" class="btn secondary" value="cancel">取消</button>
      <button id="dlgOk" class="btn primary" value="ok">確定</button>
    </div>
  </form>
</dialog>

<script src="app.js"></script>
</body>
</html>
